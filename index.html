<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Choice Maker</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-gap: 20px;
      margin-top: 20px;
    }

    @media (max-width: 767px) {
      .container {
        grid-template-columns: 1fr;
      }
    }

    #input-container,
    #sort-container,
    #result-container {
      padding: 20px;
    }

    textarea {
      width: 100%;
      margin-bottom: 10px;
    }

    #comparison {
      text-align: center;
    }

    #result-table {
      width: 100%;
      text-align: left;
    }

    .instructions {
      margin-bottom: 20px;
    }

    .choice-button {
      margin: 10px;
    }
  </style>
</head>

<body>
  <div class="container">
    <div id="input-container">
      <div class="instructions">
        <p>Welcome to the Choice Maker! Follow the instructions below to sort your choice preferences:</p>
        <ol>
          <li>Enter your choices in the left box, one choice per line.</li>
          <li>Click the 'Start' button to begin the sorting process.</li>
          <li>Make your selection between the presented pairs by clicking the buttons or pressing '1' or '2' keys.</li>
          <li>Once all comparisons are done, your top 5 preferences will be displayed on the right side.</li>
        </ol>
      </div>
      <button onclick="startSorting()" class="btn btn-primary">Start</button>
      <button onclick="resetSorting()" class="btn btn-secondary">Reset</button>
      <textarea id="choices" class="form-control" placeholder="Enter your choices, one per line" rows="20"></textarea>
    </div>
    <div id="sort-container" style="display:none;">
      <div id="comparison">
        <!-- Comparison buttons will be inserted here -->
      </div>
    </div>
    <div id="result-container" style="display:none;">
      <table id="result-table" class="table">
        <thead>
          <tr>
            <th>Rank</th>
            <th>Choice</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  <script>
    let choices = [];
    let sortedChoices = [];
    let currentIndex = 0;
    let comparisonIndex = 0;

    function startSorting() {
      const textarea = document.getElementById('choices');
      choices = textarea.value.split('\n').filter(choice => choice.trim() !== '');
      if (choices.length < 2) {
        alert('Please enter at least two choices.');
        return;
      }
      sortedChoices = [choices[0]];
      currentIndex = 1;
      comparisonIndex = 0;
      showComparison();
    }

    function resetSorting() {
      choices = [];
      sortedChoices = [];
      currentIndex = 0;
      comparisonIndex = 0;
      document.getElementById('sort-container').style.display = 'none';
      document.getElementById('result-container').style.display = 'none';
    }

    function showComparison() {
      if (currentIndex >= choices.length) {
        showResult();
        return;
      }
      const comparisonDiv = document.getElementById('comparison');
      comparisonDiv.innerHTML = `
            <button onclick="selectChoice(1)" class="btn btn-info choice-button">
                <p>${sortedChoices[comparisonIndex]}</p>
            </button>
            <button onclick="selectChoice(2)" class="btn btn-info choice-button">
                <p>${choices[currentIndex]}</p>
            </button>
        `;
      document.getElementById('sort-container').style.display = 'block';
    }

    function selectChoice(selectedIndex) {
      if (selectedIndex === 1) {
        comparisonIndex++;
        if (comparisonIndex >= sortedChoices.length) {
          sortedChoices.push(choices[currentIndex]);
          currentIndex++;
          comparisonIndex = 0;
        }
      } else {
        sortedChoices.splice(comparisonIndex, 0, choices[currentIndex]);
        currentIndex++;
        comparisonIndex = 0;
      }
      showComparison();
    }

    function showResult() {
      document.getElementById('sort-container').style.display = 'none';
      const resultTableBody = document.querySelector('#result-table tbody');
      resultTableBody.innerHTML = '';
      for (let i = 0; i < Math.min(5, sortedChoices.length); i++) {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${i + 1}</td><td>${sortedChoices[i]}</td>`;
        resultTableBody.appendChild(row);
      }
      document.getElementById('result-container').style.display = 'block';
    }

    document.addEventListener('keydown', function (event) {
      if (event.key === '1' || event.key === '2') selectChoice(parseInt(event.key));
    });
  </script>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>

</html>
